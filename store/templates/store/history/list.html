{% extends 'store/base.html' %}
{% block content %}
<div class="card p-4 shadow border-0 animate__animated animate__fadeIn">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">History</h2>
        <div class="col-md-4">
            <select class="form-select border-danger" onchange="location = this.value;">
                {% for c in all_customers %}
                    <option value="{% url 'history_page' %}?customer_id={{ c.id }}" {% if c.id == customer.id %}selected{% endif %}>
                        View for: {{ c.first_name }}
                    </option>
                {% endfor %}
            </select>
        </div>
    </div>

    {% for order in orders %}
    <div class="card mb-3 border-start border-danger border-4 shadow-sm">
        <div class="card-body">
            <div class="d-flex justify-content-between">
                <span class="fw-bold">Order #{{ order.id }}</span>
                <span class="text-muted">{{ order.date_ordered|date:"M d, Y" }}</span>
            </div>
            <hr>
            {% for item in order.orderitem_set.all %}
            <div class="d-flex justify-content-between small">
                <span>{{ item.product.product_name }}</span>
                <span class="fw-bold">â‚±{{ item.product.price }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
    {% empty %}
    <p class="text-center py-5 text-muted">No completed orders found.</p>
    {% endfor %}
</div>
{% endblock %}