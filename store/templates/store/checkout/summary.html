{% extends 'store/base.html' %}
{% block content %}
<div class="card p-4 shadow animate__animated animate__fadeIn">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Order Summary</h2>
        
        <div class="col-md-4">
            <label class="small fw-bold">View Cart For:</label>
            <select class="form-select" onchange="location = this.value;">
                {% for c in all_customers %}
                    <option value="{% url 'checkout_summary' %}?customer_id={{ c.id }}" 
                            {% if c.id == customer.id %}selected{% endif %}>
                        {{ c.first_name }} {{ c.last_name }}
                    </option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div class="bg-light p-3 rounded mb-4">
        <h5>Customer: <span class="text-danger">{{ customer.first_name }} {{ customer.last_name }}</span></h5>
        <p class="mb-0"><strong>Address:</strong> {{ customer.customer_address }}</p>
    </div>

    <table class="table">
        <thead>
            <tr>
                <th>Product</th>
                <th>Store</th>
                <th class="text-end">Price</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.product.product_name }}</td>
                <td>{{ item.order.store.store_name }}</td>
                <td class="text-end">â‚±{{ item.product.price }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="text-center text-muted">This customer's cart is empty.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    {% if items %}
    <form action="{% url 'process_payment' %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="customer_id" value="{{ customer.id }}">
        <button class="btn btn-danger btn-lg w-100 mt-3">Confirm and Pay</button>
    </form>
    {% endif %}
</div>
{% endblock %}